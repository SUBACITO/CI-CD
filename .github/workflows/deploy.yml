name: Deploy to VPS

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Send Telegram Notification
        if: always()
        run: |
          STATUS="${{ job.status }}"
          ACTION_URL="https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"

          if [ "$STATUS" = "success" ]; then
            MESSAGE="✅ DEPLOY SUCCESS
      Action: $ACTION_URL"
          else
            MESSAGE="❌ DEPLOY FAILED
      Action: $ACTION_URL"
          fi

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d text="$MESSAGE" || true

